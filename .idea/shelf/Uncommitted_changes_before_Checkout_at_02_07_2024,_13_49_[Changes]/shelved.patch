Index: app/src/main/java/org/dci/walletapp/JsonFilesOperations.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>package org.dci.walletapp;\n\nimport android.content.Context;\nimport android.content.ContextWrapper;\nimport android.util.Log;\n\nimport org.json.JSONArray;\nimport org.json.JSONException;\nimport org.json.JSONObject;\n\nimport java.io.BufferedReader;\nimport java.io.File;\nimport java.io.FileOutputStream;\nimport java.io.FileReader;\nimport java.io.IOException;\n\npublic class JsonFilesOperations {\n    private static JsonFilesOperations instance;\n\n    private JsonFilesOperations() {\n    }\n\n    public static JsonFilesOperations getInstance() {\n        if (instance == null) {\n            instance = new JsonFilesOperations();\n        }\n        return instance;\n    }\n\n    public void writeTransaction(Context context, Transaction transaction) {\n\n        // Get the existing data\n        JSONArray transactionsArray = readTransactions(context);\n\n        // Convert new transaction to JSON and add it to the array\n        JSONObject newTransaction = convertTransaction(transaction);\n        transactionsArray.put(newTransaction);\n\n        // Pretty-print the updated array and write it back to the file\n        String data = null;\n        try {\n            data = transactionsArray.toString(4);\n        } catch (JSONException e) {\n            throw new RuntimeException(e);\n        }\n        ContextWrapper contextWrapper = new ContextWrapper(context);\n        File directory = contextWrapper.getDir(context.getFilesDir().getName(), Context.MODE_PRIVATE);\n        File file = new File(directory, \"transaction.json\");\n\n        try (FileOutputStream fos = new FileOutputStream(file, false)) {\n            fos.write(data.getBytes());\n        } catch (IOException e) {\n            throw new RuntimeException(e);\n        }\n    }\n\n    public JSONArray readTransactions(Context context) {\n\n\n        ContextWrapper contextWrapper = new ContextWrapper(context);\n        File directory = contextWrapper.getDir(context.getFilesDir().getName(), Context.MODE_PRIVATE);\n        File file = new File(directory, \"transaction.json\");\n\n        StringBuilder jsonString = new StringBuilder();\n\n        if (file.exists()) {\n            try (BufferedReader reader = new BufferedReader(new FileReader(file))) {\n                String line;\n                while ((line = reader.readLine()) != null) {\n                    jsonString.append(line);\n                }\n            } catch (IOException e) {\n                Log.e(\"JsonFilesOperations\", \"Error reading file\", e);\n            }\n\n            try {\n                String jsonContent = jsonString.toString().trim();\n                if (jsonContent.startsWith(\"{\")) {\n                    // If the content starts with {, wrap it in an array\n                    JSONArray jsonArray = new JSONArray();\n                    jsonArray.put(new JSONObject(jsonContent));\n                    return jsonArray;\n                } else {\n                    return new JSONArray(jsonContent);\n                }\n            } catch (JSONException e) {\n                Log.e(\"JsonFilesOperations\", \"Error parsing JSON\", e);\n            }\n        }\n\n        return new JSONArray();  // Return an empty array if the file doesn't exist or is empty\n    }\n\n\n    private JSONObject convertTransaction(Transaction transaction) {\n        JSONObject jsonObject = new JSONObject();\n        try {\n            jsonObject.put(\"isIncome\", transaction.isIncome());   // Store as boolean\n            jsonObject.put(\"amount\", transaction.getAmount());\n            jsonObject.put(\"dateTime\", transaction.getDateTime().toString());\n            jsonObject.put(\"source\", transaction.getSource());\n            jsonObject.put(\"description\", transaction.getDescription());\n        } catch (JSONException e) {\n            throw new RuntimeException(e);\n        }\n\n        return jsonObject;\n    }\n}\n
===================================================================
diff --git a/app/src/main/java/org/dci/walletapp/JsonFilesOperations.java b/app/src/main/java/org/dci/walletapp/JsonFilesOperations.java
--- a/app/src/main/java/org/dci/walletapp/JsonFilesOperations.java	
+++ b/app/src/main/java/org/dci/walletapp/JsonFilesOperations.java	
@@ -56,7 +56,6 @@
 
     public JSONArray readTransactions(Context context) {
 
-
         ContextWrapper contextWrapper = new ContextWrapper(context);
         File directory = contextWrapper.getDir(context.getFilesDir().getName(), Context.MODE_PRIVATE);
         File file = new File(directory, "transaction.json");
